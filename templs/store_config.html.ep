%#
%# $Id$
%#
% layout 'default';
% title 'Dumper';
% use Mojo::Util qw(dumper);

% my $req = $self->req;
% my $m = $self->app->model;

% my $store_id = $req->param('id');
% my $hostname = $req->param('hostname');
% my $username = $req->param('username');
% my $password = $req->param('password');

% my $res = $m->store_config($store_id, $hostname, $username, $password);

% my $job_id = $m->job_create;

% $m->job_update(
%     $job_id,
%     type => 'storereconf',
%     sourceid => $store_id,
%     destid => $store_id,
%     author => $c->session('username')
% );

% if ($res) {
    <div class="callout success">
        Store <%= $hostname %> was updated successful.
    </div>
%   $m->job_update($job_id, status => 'done', error => 'noerr', stop => $m->timestamp);
% }

% unless ($res) {
    <div class="callout alert">
        Store <%= $hostname %> was updated unsuccessful.
    </div>
%   $m->job_update($job_id, status => 'error', error => 'reconferror', stop => $m->timestamp);
% }

<div class="text-center">
    <a class="button" href="/store/list">StoreList</a>
    <a class="button" href="/store/data/list?id=<%= $store_id %>">DataList</a>
</div>
%#EOF

