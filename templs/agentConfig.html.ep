%#
%# $Id$
%#
% layout 'default';
% title 'Dumper';
% use Mojo::Util qw(dumper);
%
% use utf8;
% use strict;
%
% my $agentID = $req->param('id');
% my $hostname = $req->param('hostname');
% my $username = $req->param('username');
% my $password = $req->param('password');
%
% my $m = $self->app->model;
% my $res = $m->agentConfig($agentID, $hostname, $username, $password);
%
% my $jobID = $m->jobCreate;
%
% $m->jobUpdate(
%     $jobID,
%     type => 'agentreconf',
%     sourceid => $agentID,
%     destid => $agentID,
%     author => $c->session('username')
% );
%
% if ($res) {
    <div class="callout success">
        Agent <%= $hostname %> was updated successful.
    </div>
%   $m->jobUpdate($jobID, status => 'done', error => 'noerr', stop => $m->timestamp);
% }
%
% unless ($res) {
    <div class="callout alert">
        Agent <%= $hostname %> was updated unsuccessful.
    </div>
%   $m->jobUpdate($jobID, status => 'error', error => 'reconferror', stop => $m->timestamp);
% }
%
<div class="text-center">
    <a class="button" href="/agent/list">AgentList</a>
    <a class="button" href="/agent/db/list?id=<%= $agentID %>">DBList</a>
</div>
%#EOF

